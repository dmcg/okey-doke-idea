buildscript {
    ext.kotlin_version = "1.1.1"
    repositories {
        mavenCentral()
        maven { url "https://oss.sonatype.org/content/repositories/snapshots/" }
        maven { url "http://dl.bintray.com/jetbrains/intellij-plugin-service" }
    }
}

plugins {
    id "org.jetbrains.intellij" version "0.4.10"
    id "org.jetbrains.kotlin.jvm" version "1.1.1"
}
apply plugin:"java"
apply plugin:"kotlin"
apply plugin:"idea"
apply plugin:"org.jetbrains.intellij"

sourceCompatibility = 1.8
targetCompatibility = 1.8

repositories {
    mavenCentral()
    maven { url "lib" }
}

sourceSets {
    main {
        kotlin.srcDir "src"
        resources.srcDir "resources"
    }
    test {
        kotlin.srcDir "test"
    }
}

compileKotlin {
    kotlinOptions {
        jvmTarget = "1.8"
        apiVersion = "1.0"
        languageVersion = "1.1"
    }
}

intellij {
	def ideVersion = System.getenv().getOrDefault("OKEYDOKE_PLUGIN_IDEA_VERSION",
		"IC-192.5728.98" // This IJ version because it has "java" plugin extracted from core.
//        "LATEST-EAP-SNAPSHOT"
	)
	println("Using ide version: ${ideVersion}")
	version ideVersion
    pluginName "okey-doke-idea"
    downloadSources true
    sameSinceUntilBuild false
    updateSinceUntilBuild false
	plugins = ["java", "Kotlin", "junit"]
}